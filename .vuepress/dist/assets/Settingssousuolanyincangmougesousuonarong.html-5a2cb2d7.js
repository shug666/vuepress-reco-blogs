import{_ as t,r as p,o as e,c,b as s,d as n,e as o,a as l}from"./app-e8f85126.js";const i={},u=l(`<h2 id="背景" tabindex="-1"><a class="header-anchor" href="#背景" aria-hidden="true">#</a> 背景</h2><p>目的：根据项目需要，删除&quot;Ethernet&quot;和&quot;Ethernet tethering&quot;相关内容，即在Settings应用中的搜索框中，无法搜索到相应的内容。</p><h2 id="过程" tabindex="-1"><a class="header-anchor" href="#过程" aria-hidden="true">#</a> 过程</h2><p>首先，需要找到涉及&quot;Ethernet tethering&quot;的类，以及对应的布局文件：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>res/xml/network_provider_settings.xml

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Preference</span>
        <span class="token attr-name"><span class="token namespace">android:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>connected_ethernet_network<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/ethernet<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>summary</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/to_switch_networks_disconnect_ethernet<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>icon</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@drawable/ic_settings_ethernet<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>根据network_provider_settings，去找加载这个布局的类：</p><p>NetworkProviderSettings.java</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">SearchIndexProvider</span> <span class="token constant">SEARCH_INDEX_DATA_PROVIDER</span> <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">SearchIndexProvider</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>xml<span class="token punctuation">.</span>network_provider_settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@VisibleForTesting</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SearchIndexProvider</span> <span class="token keyword">extends</span> <span class="token class-name">BaseSearchIndexProvider</span> <span class="token punctuation">{</span>

        <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">WifiRestriction</span> mWifiRestriction<span class="token punctuation">;</span>

        <span class="token class-name">SearchIndexProvider</span><span class="token punctuation">(</span><span class="token keyword">int</span> xmlRes<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>xmlRes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mWifiRestriction <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WifiRestriction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@VisibleForTesting</span>
        <span class="token class-name">SearchIndexProvider</span><span class="token punctuation">(</span><span class="token keyword">int</span> xmlRes<span class="token punctuation">,</span> <span class="token class-name">WifiRestriction</span> wifiRestriction<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span>xmlRes<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mWifiRestriction <span class="token operator">=</span> wifiRestriction<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 获取不可索引keys。在搜索中，如果在这里面keys.add了相应的参数，则在Search bar中无法搜索到</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getNonIndexableKeys</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getNonIndexableKeys</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mWifiRestriction<span class="token punctuation">.</span><span class="token function">isChangeWifiStateAllowed</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">PREF_KEY_WIFI_TOGGLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">final</span> <span class="token class-name">WifiManager</span> wifiManager <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span><span class="token class-name">WifiManager</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>wifiManager <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> keys<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">WifiSavedConfigUtils</span><span class="token punctuation">.</span><span class="token function">getAllConfigsCount</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> wifiManager<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">PREF_KEY_SAVED_NETWORKS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">DataUsageUtils</span><span class="token punctuation">.</span><span class="token function">hasWifiRadio</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">PREF_KEY_DATA_USAGE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 这里添加了&quot;PREF_KEY_CONNECTED_ETHERNET_NETWORK&quot;，目的是为了将&quot;Ethernet&quot;添加到不可搜索数组中。</span>
            keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">PREF_KEY_CONNECTED_ETHERNET_NETWORK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> keys<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>同理，找到可以找到all_tether_prefs.xml以及对应的类：AllInOneTetherSettings.java</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">BaseSearchIndexProvider</span> <span class="token constant">SEARCH_INDEX_DATA_PROVIDER</span> <span class="token operator">=</span>
            <span class="token keyword">new</span> <span class="token class-name">BaseSearchIndexProvider</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>xml<span class="token punctuation">.</span>all_tether_prefs<span class="token punctuation">)</span> <span class="token punctuation">{</span>

                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getNonIndexableKeys</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">getNonIndexableKeys</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">TetherUtil</span><span class="token punctuation">.</span><span class="token function">isTetherAvailable</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">KEY_WIFI_TETHER_NETWORK_NAME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">KEY_WIFI_TETHER_NETWORK_PASSWORD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">KEY_WIFI_TETHER_AUTO_OFF</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">KEY_WIFI_TETHER_NETWORK_AP_BAND</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">KEY_WIFI_TETHER_SECURITY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment">// 将&quot;Ethernet tethering&quot;添加到不可索引数据中。</span>
                    keys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token constant">ETHERNET_TETHER_KEY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> keys<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">protected</span> <span class="token keyword">boolean</span> <span class="token function">isPageSearchEnabled</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token class-name">FeatureFlagUtils</span><span class="token punctuation">.</span><span class="token function">isEnabled</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token class-name">FeatureFlags</span><span class="token punctuation">.</span><span class="token constant">TETHER_ALL_IN_ONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">AbstractPreferenceController</span><span class="token punctuation">&gt;</span></span> <span class="token function">createPreferenceControllers</span><span class="token punctuation">(</span>
                        <span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token function">buildPreferenceControllers</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token keyword">null</span> <span class="token comment">/*listener*/</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="终极版" tabindex="-1"><a class="header-anchor" href="#终极版" aria-hidden="true">#</a> 终极版</h2><p>在<code>packages/apps/SettingsIntelligence/src/com/android/settings/intelligence/search/SearchResultAggregator.java</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span></span> <span class="token function">mergeSearchResults</span><span class="token punctuation">(</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">,</span> <span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> taskResults<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span></span> searchResults <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// First add db results as a special case</span>
        searchResults<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>taskResults<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token class-name">DatabaseResultTask</span><span class="token punctuation">.</span><span class="token constant">QUERY_WORKER_ID</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Merge the rest into result list: add everything to heap then pop them out one by one.</span>
        <span class="token keyword">final</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span></span> heap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PriorityQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span></span> taskResult <span class="token operator">:</span> taskResults<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            heap<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>taskResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token operator">!</span>heap<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            searchResults<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>heap<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

<span class="token operator">+</span>
<span class="token operator">+</span>        <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span></span> searchResultIterator <span class="token operator">=</span> searchResults<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>searchResultIterator<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">+</span>            <span class="token class-name">String</span> dataKey <span class="token operator">=</span> searchResultIterator<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dataKey<span class="token punctuation">;</span>
<span class="token operator">+</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;device_and_call_settings&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>dataKey<span class="token punctuation">)</span> <span class="token operator">||</span>
<span class="token operator">+</span>                    <span class="token string">&quot;com.google.android.cellbroadcastreceiver&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>dataKey<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">+</span>                <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;searchResult: dataKey = &quot;</span> <span class="token operator">+</span> dataKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>                searchResultIterator<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>            <span class="token punctuation">}</span>
<span class="token operator">+</span>        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> searchResults<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>下面这种效率较低，但比较直接，实在不行，可考虑此种方法，一般建议上面这种方法</p><p>在<code>packages/apps/SettingsIntelligence/src/com/android/settings/intelligence/search/SearchResultsAdapter.java</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token operator">-</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postSearchResults</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span></span> newSearchResults<span class="token punctuation">,</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">-</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>i <span class="token operator">&lt;</span> newSearchResults<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">-</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>newSearchResults<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>breadcrumbs<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token operator">-</span>                    <span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>string<span class="token punctuation">.</span>applications_settings<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token operator">-</span>                    <span class="token operator">&amp;&amp;</span> newSearchResults<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>dataKey<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;com.google.android.cellbroadcastreceiver&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token operator">-</span>                newSearchResults<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">-</span>            <span class="token punctuation">}</span>
<span class="token operator">-</span>        <span class="token punctuation">}</span>
         <span class="token keyword">final</span> <span class="token class-name">DiffUtil<span class="token punctuation">.</span>DiffResult</span> diffResult <span class="token operator">=</span> <span class="token class-name">DiffUtil</span><span class="token punctuation">.</span><span class="token function">calculateDiff</span><span class="token punctuation">(</span>
                 <span class="token keyword">new</span> <span class="token class-name">SearchResultDiffCallback</span><span class="token punctuation">(</span>mSearchResults<span class="token punctuation">,</span> newSearchResults<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         mSearchResults<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         mSearchResults<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>newSearchResults<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token operator">+</span>        <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span>Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token string">&quot;ww&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;mSearchResults :&quot;</span><span class="token operator">+</span>mSearchResults<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         diffResult<span class="token punctuation">.</span><span class="token function">dispatchUpdatesTo</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         mFragment<span class="token punctuation">.</span><span class="token function">onSearchResultsDisplayed</span><span class="token punctuation">(</span>mSearchResults<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="结论" tabindex="-1"><a class="header-anchor" href="#结论" aria-hidden="true">#</a> 结论：</h2><p>注意：make成功后，push或install后，此时只是将当前的修改生效，但是数据库中仍然保留了之前的搜索记录，因此需要删除对应的数据库。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>$ adb shell
$ <span class="token builtin class-name">cd</span> data/data/com.android.xxx.intelligence/
$ <span class="token function">rm</span> <span class="token parameter variable">-rf</span> databases
$ <span class="token function">reboot</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>删除后，重启生效。此时就不会再搜索到对应的内容了。</p><p>注：此篇以记录处理问题时，忽略的小细节。不足之处请指出。</p><p>PS: xml中修改<code>settings:searchable=&quot;false&quot;</code></p>`,22),k={href:"https://blog.csdn.net/m0_59266526/article/details/135848375",target:"_blank",rel:"noopener noreferrer"};function r(d,v){const a=p("ExternalLinkIcon");return e(),c("div",null,[u,s("p",null,[n("本文转自 "),s("a",k,[n("https://blog.csdn.net/m0_59266526/article/details/135848375"),o(a)]),n("，如有侵权，请联系删除。")])])}const b=t(i,[["render",r],["__file","Settingssousuolanyincangmougesousuonarong.html.vue"]]);export{b as default};
