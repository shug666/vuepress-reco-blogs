import{_ as n,r as s,o as t,c as r,b as i,d as e,e as o,a as l}from"./app-f541e591.js";const d={},c=l(`<h1 id="问题详情" tabindex="-1"><a class="header-anchor" href="#问题详情" aria-hidden="true">#</a> 问题详情</h1><p>在SDK环境上将AndroidQ的Email应用搬到AndroidS上使用，使用mm命令进行编译毫无问题，可以正常生产apk，然后就自信满满提交了补丁。但是其他同事更新代码后整体编译，就报了以下的错误：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>[ 91% 1133/1239] Verifying uses-libraries: out/target/common/obj/APPS/Email_intermediates/manifest/AndroidManifest.xml
FAILED: out/target/common/obj/APPS/Email_intermediates/enforce_uses_libraries.status
/bin/bash -c &quot;(rm -f out/target/common/obj/APPS/Email_intermediates/enforce_uses_libraries.status ) &amp;&amp; (build/soong/scripts/manifest_check.py     --enforce-uses-libraries        --enforce-uses-libraries-status out/target/common/obj/APPS/Email_intermediates/enforce_uses_libraries.status       --aapt out/host/linux-x86/bin/aapt                                 out/target/common/obj/APPS/Email_intermediates/manifest/AndroidManifest.xml )&quot;
error: mismatch in the &lt;uses-library&gt; tags between the build system and the manifest:
        - required libraries in build system: []
                         vs. in the manifest: [org.apache.http.legacy]
        - optional libraries in build system: []
                         vs. in the manifest: []
        - tags in the manifest (out/target/common/obj/APPS/Email_intermediates/manifest/AndroidManifest.xml):
                &lt;uses-library android:name=&quot;org.apache.http.legacy&quot; android:required=&quot;true&quot;/&gt;

note: the following options are available:
        - to temporarily disable the check on command line, rebuild with RELAX_USES_LIBRARY_CHECK=true (this will set compiler filter &quot;verify&quot; and disable AOT-compilation in dexpreopt)
        - to temporarily disable the check for the whole product, set PRODUCT_BROKEN_VERIFY_USES_LIBRARIES := true in the product makefiles
        - to fix the check, make build system properties coherent with the manifest
        - see build/make/Changes.md for details
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>报错信息是执行manifest_check.py发现，声明请求使用的libraries跟AndroidManifest.xml中声明的不一致，导致的报错。</p><h1 id="解决方法" tabindex="-1"><a class="header-anchor" href="#解决方法" aria-hidden="true">#</a> 解决方法</h1><p><!--1.如manifest\\_check.py中报错信息的提示，方案中配置RELAX\\_USES\\_LIBRARY\\_CHECK=true或者PRODUCT\\_BROKEN\\_VERIFY\\_USES\\_LIBRARIES := true  (无效)--></p><p>2.令LOCAL_ENFORCE_USES_LIBRARIES的值为false，如在Android.mk/Android.bp中设置：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>mk:     LOCAL_ENFORCE_USES_LIBRARIES :<span class="token operator">=</span> <span class="token boolean">false</span>
bp:     enforce_uses_libs: <span class="token boolean">false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>或者LOCAL_MODULE_TAGS设置为tests，LOCAL_COMPATIBILITY_SUITE设置为非空。方案中设置WITH_DEXPREOPT为true等等，具体参考build/make/core/dex_preopt_odex_install.mk</p><p>3.正确设置LOCAL_USES_LIBRARIES的值。</p>`,10),m={href:"https://blog.csdn.net/zcyxiaxi/article/details/121555788",target:"_blank",rel:"noopener noreferrer"};function u(b,_){const a=s("ExternalLinkIcon");return t(),r("div",null,[c,i("p",null,[e("本文转自 "),i("a",m,[e("https://blog.csdn.net/zcyxiaxi/article/details/121555788"),o(a)]),e("，如有侵权，请联系删除。")])])}const h=n(d,[["render",u],["__file","Android12-AndroidManifestshiyonguses-librarybianyibaocuojiejue.html.vue"]]);export{h as default};
