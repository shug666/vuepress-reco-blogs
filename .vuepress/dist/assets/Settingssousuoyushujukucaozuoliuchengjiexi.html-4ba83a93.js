import{_ as t,r as e,o as p,c as o,b as s,d as n,e as c,a as l}from"./app-e8f85126.js";const i={},u=l(`<h2 id="settings里搜索框的搜索流程" tabindex="-1"><a class="header-anchor" href="#settings里搜索框的搜索流程" aria-hidden="true">#</a> Settings里搜索框的搜索流程</h2><p><img src="https://raw.githubusercontent.com/shug666/image/main/images44c9b50d545ba05a8c57b6aa6b41956f.png" alt="在这里插入图片描述"><br> settings 里的 app info的搜索是单独的在InstalledAppResultTask 的query() 方法里，通过<code>Settings.ACTION_APPLICATION_DETAILS_SETTINGS</code>跳转</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Settings</span><span class="token punctuation">.</span><span class="token constant">ACTION_APPLICATION_DETAILS_SETTINGS</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setAction</span><span class="token punctuation">(</span><span class="token class-name">Settings</span><span class="token punctuation">.</span><span class="token constant">ACTION_APPLICATION_DETAILS_SETTINGS</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">fromParts</span><span class="token punctuation">(</span><span class="token constant">INTENT_SCHEME</span><span class="token punctuation">,</span> info<span class="token punctuation">.</span>packageName<span class="token punctuation">,</span> <span class="token keyword">null</span> <span class="token comment">/* fragment */</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="search完整流程" tabindex="-1"><a class="header-anchor" href="#search完整流程" aria-hidden="true">#</a> Search完整流程</h2><p>一、Settigs 里的查找有好几种,有数据库，应用，设备，辅助服务等，如下:</p><ul><li><img src="https://raw.githubusercontent.com/shug666/image/main/imagesebb786e8e7862cba8dd4748552d10dfe.png" alt="请添加图片描述"></li><li>除了数据库之外的其他几种都很直接，下面只看数据库的查找</li><li>直接看adapter ，SearchResultsAdapter:</li></ul><h3 id="设置viewholder" tabindex="-1"><a class="header-anchor" href="#设置viewholder" aria-hidden="true">#</a> 设置viewHolder</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">// src/com/android/settings/intelligence/search/SearchResultsAdapter.java</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span><span class="token class-name">SearchViewHolder</span> holder<span class="token punctuation">,</span> <span class="token keyword">int</span> position<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        holder<span class="token punctuation">.</span><span class="token function">onBind</span><span class="token punctuation">(</span>mFragment<span class="token punctuation">,</span> mSearchResults<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>position<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="给view设置图片文字等" tabindex="-1"><a class="header-anchor" href="#给view设置图片文字等" aria-hidden="true">#</a> 给view设置图片文字等</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">// src/com/android/settings/intelligence/search/SearchViewHolder.java</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBind</span><span class="token punctuation">(</span><span class="token class-name">SearchFragment</span> fragment<span class="token punctuation">,</span> <span class="token class-name">SearchResult</span> result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        titleView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>title<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// TODO (b/36101902) remove check for DYNAMIC_PLACEHOLDER</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>summary<span class="token punctuation">)</span>
                <span class="token operator">||</span> <span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>summary<span class="token punctuation">,</span> mPlaceholderSummary<span class="token punctuation">)</span>
                <span class="token operator">||</span> <span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>summary<span class="token punctuation">,</span> <span class="token constant">DYNAMIC_PLACEHOLDER</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            summaryView<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">View</span><span class="token punctuation">.</span><span class="token constant">GONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            summaryView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>summary<span class="token punctuation">)</span><span class="token punctuation">;</span>
            summaryView<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">View</span><span class="token punctuation">.</span><span class="token constant">VISIBLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token keyword">instanceof</span> <span class="token class-name">AppSearchResult</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">AppSearchResult</span> appResult <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">AppSearchResult</span><span class="token punctuation">)</span> result<span class="token punctuation">;</span>
            <span class="token class-name">PackageManager</span> pm <span class="token operator">=</span> fragment<span class="token punctuation">.</span><span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackageManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            iconView<span class="token punctuation">.</span><span class="token function">setImageDrawable</span><span class="token punctuation">(</span>appResult<span class="token punctuation">.</span>info<span class="token punctuation">.</span><span class="token function">loadIcon</span><span class="token punctuation">(</span>pm<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// Valid even when result.icon is null.</span>
            iconView<span class="token punctuation">.</span><span class="token function">setImageDrawable</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>icon<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">bindBreadcrumbView</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>那么adapter的数据哪里来的呢?看SearchFragment:</li></ul><h3 id="得到搜索结果给adapter" tabindex="-1"><a class="header-anchor" href="#得到搜索结果给adapter" aria-hidden="true">#</a> 得到搜索结果给adapter</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// src/com/android/settings/intelligence/search/SearchFragment.java  </span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Loader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">onCreateLoader</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">,</span> <span class="token class-name">Bundle</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">Activity</span> activity <span class="token operator">=</span> <span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">switch</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">case</span> <span class="token class-name">SearchCommon<span class="token punctuation">.</span>SearchLoaderId</span><span class="token punctuation">.</span><span class="token constant">SEARCH_RESULT</span><span class="token operator">:</span>
                <span class="token keyword">return</span> mSearchFeatureProvider<span class="token punctuation">.</span><span class="token function">getSearchResultLoader</span><span class="token punctuation">(</span>activity<span class="token punctuation">,</span> mQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">default</span><span class="token operator">:</span>
                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onLoadFinished</span><span class="token punctuation">(</span><span class="token class-name">Loader</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> loader<span class="token punctuation">,</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span></span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mSearchAdapter<span class="token punctuation">.</span><span class="token function">postSearchResults</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>这里的LoaderManager 是用来帮助方便查询的，具体可以看</li><li>https://developer.android.google.cn/reference/android/app/LoaderManager?hl=en</li><li>mSearchFeatureProvider这里就是SearchFeatureProviderImpl,下面看这里的LoaderManager是如何查找到数据的</li></ul><h3 id="loadermanager是如何查找到数据的" tabindex="-1"><a class="header-anchor" href="#loadermanager是如何查找到数据的" aria-hidden="true">#</a> LoaderManager是如何查找到数据的</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">// src/com/android/settings/intelligence/search/SearchFragment.java  </span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onAttach</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onAttach</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mSearchFeatureProvider <span class="token operator">=</span> <span class="token class-name">FeatureFactory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">searchFeatureProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mMetricsFeatureProvider <span class="token operator">=</span> <span class="token class-name">FeatureFactory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">metricsFeatureProvider</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>restartLoaders() 这里设置loadermanager后马上会走onCreateLoader,细节可以点进去看就可以:createAndInstallLoader。</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onQueryTextChange</span><span class="token punctuation">(</span><span class="token class-name">String</span> query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> mQuery<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mEnterQueryTimestampMs <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token keyword">boolean</span> isEmptyQuery <span class="token operator">=</span> <span class="token class-name">TextUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>query<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Hide no-results-view when the new query is not a super-string of the previous</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mQuery <span class="token operator">!=</span> <span class="token keyword">null</span>
                <span class="token operator">&amp;&amp;</span> mNoResultsView<span class="token punctuation">.</span><span class="token function">getVisibility</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token class-name">View</span><span class="token punctuation">.</span><span class="token constant">VISIBLE</span>
                <span class="token operator">&amp;&amp;</span> query<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> mQuery<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mNoResultsView<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">View</span><span class="token punctuation">.</span><span class="token constant">GONE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        mNeverEnteredQuery <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        mQuery <span class="token operator">=</span> query<span class="token punctuation">;</span>

        <span class="token comment">// If indexing is not finished, register the query text, but don&#39;t search.</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mSearchFeatureProvider<span class="token punctuation">.</span><span class="token function">isIndexingComplete</span><span class="token punctuation">(</span><span class="token function">getActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        

        <span class="token keyword">if</span> <span class="token punctuation">(</span>isEmptyQuery<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token class-name">LoaderManager</span> loaderManager <span class="token operator">=</span> <span class="token function">getLoaderManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            loaderManager<span class="token punctuation">.</span><span class="token function">destroyLoader</span><span class="token punctuation">(</span><span class="token class-name">SearchCommon<span class="token punctuation">.</span>SearchLoaderId</span><span class="token punctuation">.</span><span class="token constant">SEARCH_RESULT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mShowingSavedQuery <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            mSavedQueryController<span class="token punctuation">.</span><span class="token function">loadSavedQueries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mSearchFeatureProvider<span class="token punctuation">.</span><span class="token function">hideFeedbackButton</span><span class="token punctuation">(</span><span class="token function">getView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            mMetricsFeatureProvider<span class="token punctuation">.</span><span class="token function">logEvent</span><span class="token punctuation">(</span><span class="token class-name">SettingsIntelligenceEvent</span><span class="token punctuation">.</span><span class="token constant">PERFORM_SEARCH</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">restartLoaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>LoaderManagerImpl: 这里就是LoaderManager中转的地方</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>        <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mRetaining <span class="token operator">&amp;&amp;</span> mRetainingStarted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// Our owner is started, but we were being retained from a</span>
                <span class="token comment">// previous instance in the started state...  so there is really</span>
                <span class="token comment">// nothing to do here, since the loaders are still started.</span>
                mStarted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>mStarted<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// If loader already started, don&#39;t restart.</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            mStarted <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG</span><span class="token punctuation">)</span> <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;  Starting: &quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mLoader <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mCallbacks <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               mLoader <span class="token operator">=</span> mCallbacks<span class="token punctuation">.</span><span class="token function">onCreateLoader</span><span class="token punctuation">(</span>mId<span class="token punctuation">,</span> mArgs<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>mLoader <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>mLoader<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isMemberClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token class-name">Modifier</span><span class="token punctuation">.</span><span class="token function">isStatic</span><span class="token punctuation">(</span>mLoader<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getModifiers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span>
                            <span class="token string">&quot;Object returned from onCreateLoader must not be a non-static inner member class: &quot;</span>
                            <span class="token operator">+</span> mLoader<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>mListenerRegistered<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    mLoader<span class="token punctuation">.</span><span class="token function">registerListener</span><span class="token punctuation">(</span>mId<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    mLoader<span class="token punctuation">.</span><span class="token function">registerOnLoadCanceledListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    mListenerRegistered <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                mLoader<span class="token punctuation">.</span><span class="token function">startLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zsg 这个地方中转</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>AsyncLoader: 开始执行Loader里的方法</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">// src/com/android/settings/intelligence/utils/AsyncLoader.java</span>
    
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onStartLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mResult <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">deliverResult</span><span class="token punctuation">(</span>mResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">takeContentChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> mResult <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">forceLoad</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zsg 这里</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>AsyncTaskLoader: 这里是调用子类SearchResultLoader中的loadInBackground</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>        <span class="token comment">/* Runs on a worker thread */</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">protected</span> <span class="token class-name">D</span> <span class="token function">doInBackground</span><span class="token punctuation">(</span><span class="token class-name">Void</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> params<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG</span><span class="token punctuation">)</span> <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token keyword">this</span> <span class="token operator">+</span> <span class="token string">&quot; &gt;&gt;&gt; doInBackground&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">D</span> data <span class="token operator">=</span> <span class="token class-name">AsyncTaskLoader</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onLoadInBackground</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zsg 这里</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG</span><span class="token punctuation">)</span> <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token keyword">this</span> <span class="token operator">+</span> <span class="token string">&quot;  &lt;&lt;&lt; doInBackground&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> data<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">OperationCanceledException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isCancelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// onLoadInBackground threw a canceled exception spuriously.</span>
                    <span class="token comment">// This is problematic because it means that the LoaderManager did not</span>
                    <span class="token comment">// cancel the Loader itself and still expects to receive a result.</span>
                    <span class="token comment">// Additionally, the Loader&#39;s own state will not have been updated to</span>
                    <span class="token comment">// reflect the fact that the task was being canceled.</span>
                    <span class="token comment">// So we treat this case as an unhandled exception.</span>
                    <span class="token keyword">throw</span> ex<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG</span><span class="token punctuation">)</span> <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">v</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token keyword">this</span> <span class="token operator">+</span> <span class="token string">&quot;  &lt;&lt;&lt; doInBackground (was canceled)&quot;</span><span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>Loader: 从AsyncTaskLoader里调用过来，最后调用到onLoadFinished。这里的listener就是LoaderManager</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deliverResult</span><span class="token punctuation">(</span><span class="token class-name">D</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>mListener <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mListener<span class="token punctuation">.</span><span class="token function">onLoadComplete</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="开始执行searchfeatureproviderimpl里的task" tabindex="-1"><a class="header-anchor" href="#开始执行searchfeatureproviderimpl里的task" aria-hidden="true">#</a> 开始执行SearchFeatureProviderImpl里的Task</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">//src/com/android/settings/intelligence/search/SearchResultAggregator.java    </span>

   <span class="token annotation punctuation">@NonNull</span>
    <span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">SearchResult</span><span class="token punctuation">&gt;</span></span> <span class="token function">fetchResults</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">String</span> query<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">SearchFeatureProvider</span> mFeatureProvider <span class="token operator">=</span> <span class="token class-name">FeatureFactory</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">searchFeatureProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">ExecutorService</span> executorService <span class="token operator">=</span> mFeatureProvider<span class="token punctuation">.</span><span class="token function">getExecutorService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchQueryTask</span><span class="token punctuation">&gt;</span></span> tasks <span class="token operator">=</span>
                mFeatureProvider<span class="token punctuation">.</span><span class="token function">getSearchQueryTasks</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> query<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Start tasks</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchQueryTask</span> task <span class="token operator">:</span> tasks<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            executorService<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>task<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zsg 这里</span>
        <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>上面就到了最开始截图部分的几个task了，也就是开始查询了，除了数据库之外都是直接查询的，但是数据库里的数据是哪里来的呢?</li><li>SearchFragment: Settings 11、updateIndexAsync 这里是最开始查找</li></ul><h3 id="所有contentprovide-生成数据库的地方" tabindex="-1"><a class="header-anchor" href="#所有contentprovide-生成数据库的地方" aria-hidden="true">#</a> 所有contentprovide 生成数据库的地方</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">// src/com/android/settings/intelligence/search/SearchFragment.java</span>

	<span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setHasOptionsMenu</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> <span class="token class-name">LoaderManager</span> loaderManager <span class="token operator">=</span> <span class="token function">getLoaderManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mSearchAdapter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SearchResultsAdapter</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token comment">/* fragment */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mSavedQueryController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SavedQueryController</span><span class="token punctuation">(</span>
                <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> loaderManager<span class="token punctuation">,</span> mSearchAdapter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mSearchFeatureProvider<span class="token punctuation">.</span><span class="token function">initFeedbackButton</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>savedInstanceState <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mQuery <span class="token operator">=</span> savedInstanceState<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token class-name">SearchCommon</span><span class="token punctuation">.</span><span class="token constant">STATE_QUERY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mNeverEnteredQuery <span class="token operator">=</span> savedInstanceState<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token class-name">SearchCommon</span><span class="token punctuation">.</span><span class="token constant">STATE_NEVER_ENTERED_QUERY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            mShowingSavedQuery <span class="token operator">=</span> savedInstanceState<span class="token punctuation">.</span><span class="token function">getBoolean</span><span class="token punctuation">(</span><span class="token class-name">SearchCommon</span><span class="token punctuation">.</span><span class="token constant">STATE_SHOWING_SAVED_QUERY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            mShowingSavedQuery <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        mSearchFeatureProvider<span class="token punctuation">.</span><span class="token function">updateIndexAsync</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span> <span class="token comment">/* indexingCallback */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">SearchFeatureProvider</span><span class="token punctuation">.</span><span class="token constant">DEBUG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;onCreate spent &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot; ms&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        mmiIntent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">ACTION_MAIN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ComponentName</span> mmiCtn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComponentName</span><span class="token punctuation">(</span><span class="token string">&quot;com.qualcomm.qti.qmmi&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;com.qualcomm.qti.qmmi.framework.HomeActivity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mmiIntent<span class="token punctuation">.</span><span class="token function">setFlags</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">FLAG_ACTIVITY_NEW_TASK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mmiIntent<span class="token punctuation">.</span><span class="token function">setComponent</span><span class="token punctuation">(</span>mmiCtn<span class="token punctuation">)</span><span class="token punctuation">;</span>

        hardwareInfoIntent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ComponentName</span> hardwareInfoCtn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ComponentName</span><span class="token punctuation">(</span><span class="token string">&quot;com.qualcomm.qti.qmmi&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;com.qualcomm.qti.qmmi.framework.HardwareInfoActivity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hardwareInfoIntent<span class="token punctuation">.</span><span class="token function">setFlags</span><span class="token punctuation">(</span><span class="token class-name">Intent</span><span class="token punctuation">.</span><span class="token constant">FLAG_ACTIVITY_NEW_TASK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        hardwareInfoIntent<span class="token punctuation">.</span><span class="token function">setComponent</span><span class="token punctuation">(</span>hardwareInfoCtn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>DatabaseIndexingManager 通过PROVIDER_INTERFACE获取所有设置这个action的contentprovide</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token comment">// src/com/android/settings/intelligence/search/indexing/DatabaseIndexingManager.java</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performIndexing</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">SearchIndexablesContract</span><span class="token punctuation">.</span><span class="token constant">PROVIDER_INTERFACE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ResolveInfo</span><span class="token punctuation">&gt;</span></span> providers <span class="token operator">=</span>
                mContext<span class="token punctuation">.</span><span class="token function">getPackageManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">queryIntentContentProviders</span><span class="token punctuation">(</span>intent<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> <span class="token keyword">boolean</span> isFullIndex <span class="token operator">=</span> <span class="token class-name">IndexDatabaseHelper</span><span class="token punctuation">.</span><span class="token function">isFullIndex</span><span class="token punctuation">(</span>mContext<span class="token punctuation">,</span> providers<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>isFullIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">rebuildDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">PreIndexData</span> indexData <span class="token operator">=</span> <span class="token function">getIndexDataFromProviders</span><span class="token punctuation">(</span>providers<span class="token punctuation">,</span> isFullIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">final</span> <span class="token keyword">long</span> updateDatabaseStartTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">updateDatabase</span><span class="token punctuation">(</span>indexData<span class="token punctuation">,</span> isFullIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">IndexDatabaseHelper</span><span class="token punctuation">.</span><span class="token function">setIndexed</span><span class="token punctuation">(</span>mContext<span class="token punctuation">,</span> providers<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">DEBUG</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token keyword">long</span> updateDatabaseTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> updateDatabaseStartTime<span class="token punctuation">;</span>
            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">d</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;performIndexing updateDatabase took time: &quot;</span> <span class="token operator">+</span> updateDatabaseTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>PreIndexDataCollector 创建URI后通过getIndexablesForRawDataUri获取数据</li></ul><h3 id="通过getindexablesforrawdatauri获取数据" tabindex="-1"><a class="header-anchor" href="#通过getindexablesforrawdatauri获取数据" aria-hidden="true">#</a> 通过getIndexablesForRawDataUri获取数据</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>	<span class="token comment">// src/com/android/settings/intelligence/search/indexing/PreIndexDataCollector.java    </span>

	<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addIndexablesFromRemoteProvider</span><span class="token punctuation">(</span><span class="token class-name">String</span> packageName<span class="token punctuation">,</span> <span class="token class-name">String</span> authority<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">final</span> <span class="token class-name">Context</span> context <span class="token operator">=</span> mContext<span class="token punctuation">.</span><span class="token function">createPackageContext</span><span class="token punctuation">(</span>packageName<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">final</span> <span class="token class-name">Uri</span> uriForResources <span class="token operator">=</span> <span class="token function">buildUriForXmlResources</span><span class="token punctuation">(</span>authority<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mIndexData<span class="token punctuation">.</span><span class="token function">addDataToUpdate</span><span class="token punctuation">(</span>authority<span class="token punctuation">,</span> <span class="token function">getIndexablesForXmlResourceUri</span><span class="token punctuation">(</span>
                    context<span class="token punctuation">,</span> packageName<span class="token punctuation">,</span> uriForResources<span class="token punctuation">,</span>
                    <span class="token class-name">SearchIndexablesContract</span><span class="token punctuation">.</span><span class="token constant">INDEXABLES_XML_RES_COLUMNS</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">final</span> <span class="token class-name">Uri</span> uriForRawData <span class="token operator">=</span> <span class="token function">buildUriForRawData</span><span class="token punctuation">(</span>authority<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mIndexData<span class="token punctuation">.</span><span class="token function">addDataToUpdate</span><span class="token punctuation">(</span>authority<span class="token punctuation">,</span> <span class="token function">getIndexablesForRawDataUri</span><span class="token punctuation">(</span>
                    context<span class="token punctuation">,</span> packageName<span class="token punctuation">,</span> uriForRawData<span class="token punctuation">,</span>
                    <span class="token class-name">SearchIndexablesContract</span><span class="token punctuation">.</span><span class="token constant">INDEXABLES_RAW_COLUMNS</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">final</span> <span class="token class-name">Uri</span> uriForSiteMap <span class="token operator">=</span> <span class="token function">buildUriForSiteMap</span><span class="token punctuation">(</span>authority<span class="token punctuation">)</span><span class="token punctuation">;</span>
            mIndexData<span class="token punctuation">.</span><span class="token function">addSiteMapPairs</span><span class="token punctuation">(</span><span class="token function">getSiteMapFromProvider</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> uriForSiteMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">PackageManager<span class="token punctuation">.</span>NameNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">w</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;Could not create context for &quot;</span> <span class="token operator">+</span> packageName <span class="token operator">+</span> <span class="token string">&quot;: &quot;</span>
                    <span class="token operator">+</span> <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">getStackTraceString</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>这里就会去查询对应的contentprovide，以Settings的contentprovide为例</li><li>SearchIndexablesProvider: 这里在framework里调用对应contentprovide的query</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    
	<span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Cursor</span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">Uri</span> uri<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> projection<span class="token punctuation">,</span> <span class="token class-name">String</span> selection<span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> selectionArgs<span class="token punctuation">,</span>
                        <span class="token class-name">String</span> sortOrder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">switch</span> <span class="token punctuation">(</span>mMatcher<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>uri<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">case</span> <span class="token constant">MATCH_RES_CODE</span><span class="token operator">:</span>
                    <span class="token keyword">return</span> <span class="token function">queryXmlResources</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token constant">MATCH_RAW_CODE</span><span class="token operator">:</span>
                    <span class="token keyword">return</span> <span class="token function">queryRawData</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token constant">MATCH_NON_INDEXABLE_KEYS_CODE</span><span class="token operator">:</span>
                    <span class="token keyword">return</span> <span class="token function">queryNonIndexableKeys</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token constant">MATCH_SITE_MAP_PAIRS_CODE</span><span class="token operator">:</span>
                    <span class="token keyword">return</span> <span class="token function">querySiteMapPairs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token constant">MATCH_SLICE_URI_PAIRS_CODE</span><span class="token operator">:</span>
                    <span class="token keyword">return</span> <span class="token function">querySliceUriPairs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">case</span> <span class="token constant">MATCH_DYNAMIC_RAW_CODE</span><span class="token operator">:</span>
                    <span class="token keyword">return</span> <span class="token function">queryDynamicRawData</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">default</span><span class="token operator">:</span>
                    <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UnsupportedOperationException</span><span class="token punctuation">(</span><span class="token string">&quot;Unknown Uri &quot;</span> <span class="token operator">+</span> uri<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedOperationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> e<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">e</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;Provider querying exception:&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>SettingsSearchIndexablesProvider: 最后调用到settings 里设置的用来搜索的BaseSearchIndexProvider ，这个不是contentprovide，只是继承了settinglib里的SearchIndexProvider接口，用来注解生成代码</li></ul><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchIndexableRaw</span><span class="token punctuation">&gt;</span></span> <span class="token function">getSearchIndexableRawFromProvider</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchIndexableData</span><span class="token punctuation">&gt;</span></span> bundles <span class="token operator">=</span> <span class="token class-name">FeatureFactory</span><span class="token punctuation">.</span><span class="token function">getFactory</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">getSearchFeatureProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSearchIndexableResources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getProviderValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchIndexableRaw</span><span class="token punctuation">&gt;</span></span> rawList <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchIndexableData</span> bundle <span class="token operator">:</span> bundles<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Indexable<span class="token punctuation">.</span>SearchIndexProvider</span> provider <span class="token operator">=</span> bundle<span class="token punctuation">.</span><span class="token function">getSearchIndexProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SearchIndexableRaw</span><span class="token punctuation">&gt;</span></span> providerRaws <span class="token operator">=</span> provider<span class="token punctuation">.</span><span class="token function">getRawDataToIndex</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>
                    <span class="token boolean">true</span> <span class="token comment">/* enabled */</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//zsg 这里</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>providerRaws <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">SearchIndexableRaw</span> raw <span class="token operator">:</span> providerRaws<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// The classname and intent information comes from the PreIndexData</span>
                <span class="token comment">// This will be more clear when provider conversion is done at PreIndex time.</span>
                raw<span class="token punctuation">.</span>className <span class="token operator">=</span> bundle<span class="token punctuation">.</span><span class="token function">getTargetClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            rawList<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>providerRaws<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> rawList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="setting数据库查看到底被哪个进程修改了" tabindex="-1"><a class="header-anchor" href="#setting数据库查看到底被哪个进程修改了" aria-hidden="true">#</a> setting数据库查看到底被哪个进程修改了</h2><p>settings 里设置的值如何在手机里查看,可以看是某个app设置的</p><p>/data/system/users/0/settings_secure.xml</p><p>/data/system/users/0/settings_global.xml</p><p>/data/system/users/0/settings_global.xml</p><p>例如：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>64<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>keyboard_backlight_enable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defaultValue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defaultSysSet</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>89<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user_setup_personalization_state<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.google.android.setupwizard<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defaultValue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>0<span class="token punctuation">&quot;</span></span> <span class="token attr-name">defaultSysSet</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>setting</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>98<span class="token punctuation">&quot;</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clock_seconds<span class="token punctuation">&quot;</span></span> <span class="token attr-name">package</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.android.systemui<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>/data/system/users/0/appwidgets.xml</code> widgets的存放路径</p><h2 id="settings中通过action跳转页面" tabindex="-1"><a class="header-anchor" href="#settings中通过action跳转页面" aria-hidden="true">#</a> settings中通过action跳转页面</h2><ul><li>ACTION_SETTINGS 系统设置界面</li><li>ACTION_APN_SETTINGS APN设置界面</li><li>ACTION_LOCATION_SOURCE_SETTINGS 定位设置界面</li><li>ACTION_AIRPLANE_MODE_SETTINGS 更多连接方式设置界面</li><li>ACTION_DATA_ROAMING_SETTINGS 双卡和移动网络设置界面</li><li>ACTION_ACCESSIBILITY_SETTINGS 无障碍设置界面/辅助功能界面</li><li>ACTION_SYNC_SETTINGS 同步设置界面</li><li>ACTION_ADD_ACCOUNT 添加账户界面</li><li>ACTION_NETWORK_OPERATOR_SETTINGS 选取运营商的界面</li><li>ACTION_SECURITY_SETTINGS 安全设置界面</li><li>ACTION_PRIVACY_SETTINGS 备份重置设置界面</li><li>ACTION_VPN_SETTINGS VPN设置界面,可能不存在</li><li>ACTION_WIFI_SETTINGS 无线网设置界面</li><li>ACTION_WIFI_IP_SETTINGS WIFI的IP设置</li><li>ACTION_BLUETOOTH_SETTINGS 蓝牙设置</li><li>ACTION_CAST_SETTINGS 投射设置</li><li>ACTION_DATE_SETTINGS 日期时间设置</li><li>ACTION_SOUND_SETTINGS 声音设置</li><li>ACTION_DISPLAY_SETTINGS 显示设置</li><li>ACTION_LOCALE_SETTINGS 语言设置</li><li>ACTION_VOICE_INPUT_SETTINGS 辅助应用和语音输入设置</li><li>ACTION_INPUT_METHOD_SETTINGS 语言和输入法设置</li><li>ACTION_USER_DICTIONARY_SETTINGS 个人字典设置界面</li><li>ACTION_INTERNAL_STORAGE_SETTINGS 存储空间设置的界面</li><li>ACTION_SEARCH_SETTINGS 搜索设置界面</li><li>ACTION_APPLICATION_DEVELOPMENT_SETTINGS 开发者选项</li><li>ACTION_DEVICE_INFO_SETTINGS 手机状态信息的界面</li><li>ACTION_DREAM_SETTINGS 互动屏保设置的界面</li><li>ACTION_NOTIFICATION_LISTENER_SETTINGS 通知使用权设置的界面</li><li>ACTION_NOTIFICATION_POLICY_ACCESS_SETTINGS 勿扰权限设置的界面</li><li>ACTION_CAPTIONING_SETTINGS 字幕设置的界面</li><li>ACTION_PRINT_SETTINGS 打印设置界面</li><li>ACTION_BATTERY_SAVER_SETTINGS 节电助手界面</li><li>ACTION_HOME_SETTINGS 主屏幕设置界面</li><li>ACTION_APPLICATION_DETAILS_SETTINGS 根据包名跳转到系统自带的应用程序信息</li><li>ACTION_APPLICATION_SETTINGS 应用程序列表</li><li>ACTION_MANAGE_ALL_APPLICATIONS_SETTINGS 应用程序界面【所有的】</li><li>ACTION_MANAGE_APPLICATIONS_SETTINGS 应用程序列表界面【已安装的】</li><li>ACTION_INPUT_METHOD_SUBTYPE_SETTINGS 【API 11及以上】语言选择界面 【多国语言选择】</li><li>ACTION_NFCSHARING_SETTINGS 显示NFC共享设置【API 14及以上】</li><li>ACTION_NFC_SETTINGS 显示NFC设置【API 16及以上】</li><li>ACTION_QUICK_LAUNCH_SETTINGS 快速启动设置界面</li></ul><p>其中，根据包名跳转到系统自带的应用程序信息界面的方式为：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token class-name">Uri</span> packageURI <span class="token operator">=</span> <span class="token class-name">Uri</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;package:&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;com.tencent.WBlog&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token class-name">Intent</span> intent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intent</span><span class="token punctuation">(</span><span class="token class-name">Settings</span><span class="token punctuation">.</span><span class="token constant">ACTION_APPLICATION_DETAILS_SETTINGS</span><span class="token punctuation">,</span>packageURI<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token function">startIntent</span><span class="token punctuation">(</span>intent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,52),k={href:"https://blog.csdn.net/qq_34250794/article/details/116014891?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-116014891-blog-106889572.235%5Ev43%5Epc_blog_bottom_relevance_base7&spm=1001.2101.3001.4242.1&utm_relevant_index=3",target:"_blank",rel:"noopener noreferrer"};function r(d,v){const a=e("ExternalLinkIcon");return p(),o("div",null,[u,s("p",null,[n("本文转自 "),s("a",k,[n("https://blog.csdn.net/qq_34250794/article/details/116014891?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_baidulandingword~default-0-116014891-blog-106889572.235^v43^pc_blog_bottom_relevance_base7&spm=1001.2101.3001.4242.1&utm_relevant_index=3"),c(a)]),n("，如有侵权，请联系删除。")])])}const b=t(i,[["render",r],["__file","Settingssousuoyushujukucaozuoliuchengjiexi.html.vue"]]);export{b as default};
