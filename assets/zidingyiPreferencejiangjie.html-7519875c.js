import{_ as t,r as e,o as p,c,b as a,d as n,e as o,a as l}from"./app-e8f85126.js";const i={},u=l(`<h2 id="preference-简单介绍" tabindex="-1"><a class="header-anchor" href="#preference-简单介绍" aria-hidden="true">#</a> Preference 简单介绍</h2><ul><li><p>Android Preference 是一种可以在Android应用程序中使用的预设用户界面组件，</p><p>用于在应用程序中提供一致且易于使用的界面，用于设置和配置应用程序的各个部分。</p></li><li><p>Android Preference提供了几种不同类型的偏好设置，包括复选框、单选按钮、开关和滑块等。</p><p>这些偏好设置可以轻松添加到应用程序的用户界面中，并可以使用Android提供的预设样式和布局进行自定义。<br> 要在Android应用程序中使用Preference，您需要在应用程序的XML资源文件中定义每个偏好设置的首选项元素。</p><p>每个首选项元素都具有唯一的键和显示给用户的值。</p><p>当用户更改任何偏好设置时，Android会自动保存更改，并在用户下次启动应用程序时恢复它们。</p></li></ul><p>Android SharePreference 可以保存配置文件到apk数据目录下的xml文件中。</p><p>Android Preference 和 SharePreference 的关系在于，当用户通过 Android Preference 用户界面更改设置时，这些更改会保存在 SharePreference 中。</p><p>Android Preference 使用 SharePreference 存储和检索每个设置的值。</p><p>当用户再次打开应用程序时，Android Preference 会从 SharePreference 中检索先前保存的设置值，并相应地更新用户界面。</p><p>简单的说Android的Preference就是一个组件或者一个框架，它能自动记忆某个开关按钮的状态，</p><p>比如不加任何Java代码控制的情况，写一个SwitchPreference开关，开关状态改变后后，</p><p>退出应用，下次打开应用就会显示上次应用关闭前的开关的状态。</p><p>Android Preference 对于 Android 应用程序的开发具有重要的意义，</p><p>因为它提供了一种创建一致且易于使用的设置界面的便捷方式。</p><p>通过使用 Android Preference，开发人员可以快速为应用程序</p><p>的不同设置和配置创建一个熟悉的用户界面，而无需从头开始编写自定义代码。</p><h2 id="as-demo代码示例" tabindex="-1"><a class="header-anchor" href="#as-demo代码示例" aria-hidden="true">#</a> AS demo代码示例</h2><p>1、在Android Studio创建一个Preference项目</p><p>Android Studio --&gt;File --&gt;New --&gt;new Project --&gt;Settings Activity</p><p>创建好的项目就会有一个xml文件，这个文件专门就是放Preference布局的文件。</p><p>这个是Android Studio 创建的Settings 类型应用代码，里面就包含了一个Java文件，调试运行很方便。</p><p>并且手动添加了一个 SwitchPreference开关，在Java代码里面添加了监听事件。</p><p>具体代码如下：</p><h3 id="settingsactivity-java" tabindex="-1"><a class="header-anchor" href="#settingsactivity-java" aria-hidden="true">#</a> SettingsActivity.Java</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>demo<span class="token punctuation">.</span>settings</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>os<span class="token punctuation">.</span></span><span class="token class-name">Bundle</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>provider<span class="token punctuation">.</span></span><span class="token class-name">Settings</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Log</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">android<span class="token punctuation">.</span>view<span class="token punctuation">.</span></span><span class="token class-name">View</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span><span class="token class-name">ActionBar</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>appcompat<span class="token punctuation">.</span>app<span class="token punctuation">.</span></span><span class="token class-name">AppCompatActivity</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>preference<span class="token punctuation">.</span></span><span class="token class-name">Preference</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>preference<span class="token punctuation">.</span></span><span class="token class-name">PreferenceFragmentCompat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">androidx<span class="token punctuation">.</span>preference<span class="token punctuation">.</span></span><span class="token class-name">SwitchPreference</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SettingsActivity</span> <span class="token keyword">extends</span> <span class="token class-name">AppCompatActivity</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">TAG</span> <span class="token operator">=</span> <span class="token string">&quot;SettingsActivity&quot;</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>settings_activity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>savedInstanceState <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">getSupportFragmentManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>settings<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">SettingsFragment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">SettingsFragment</span> <span class="token keyword">extends</span> <span class="token class-name">PreferenceFragmentCompat</span> <span class="token punctuation">{</span>
        <span class="token annotation punctuation">@Override</span>
        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreatePreferences</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">,</span> <span class="token class-name">String</span> rootKey<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">setPreferencesFromResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>xml<span class="token punctuation">.</span>root_preferences<span class="token punctuation">,</span> rootKey<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//监听switch开关的状态</span>
            <span class="token class-name">SwitchPreference</span>  switchPreference <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SwitchPreference</span><span class="token punctuation">)</span> <span class="token function">findPreference</span><span class="token punctuation">(</span><span class="token string">&quot;ethernet_turn_off&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            switchPreference<span class="token punctuation">.</span><span class="token function">setOnPreferenceChangeListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Preference<span class="token punctuation">.</span>OnPreferenceChangeListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@Override</span>
                <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">onPreferenceChange</span><span class="token punctuation">(</span><span class="token class-name">Preference</span> preference<span class="token punctuation">,</span> <span class="token class-name">Object</span> newValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">boolean</span> isCheck <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">boolean</span><span class="token punctuation">)</span> newValue<span class="token punctuation">;</span>
                    <span class="token class-name">Log</span><span class="token punctuation">.</span><span class="token function">i</span><span class="token punctuation">(</span><span class="token constant">TAG</span><span class="token punctuation">,</span> <span class="token string">&quot;onPreferenceChange preference = &quot;</span> <span class="token operator">+</span> preference <span class="token operator">+</span> <span class="token string">&quot;, isCheck = &quot;</span> <span class="token operator">+</span> isCheck<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            switchPreference<span class="token punctuation">.</span><span class="token function">setSummary</span><span class="token punctuation">(</span><span class="token string">&quot;IP：XXX&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//副标题，在标题下方，也可以设置空字符串</span>
        <span class="token punctuation">}</span>


    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里可以看到是使用了一个Preference相关的Fragment放置布局显示。</p><p>之前的layout布局要么不用，要么用来放Preference对应的的Fragment。<br> 其实我研究Preference 就是为了添加一个开关：SwitchPreference</p><h3 id="settings-activity-xml" tabindex="-1"><a class="header-anchor" href="#settings-activity-xml" aria-hidden="true">#</a> settings_activity.xml</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>LinearLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FrameLayout</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/settings<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>LinearLayout</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="root-preferences-xml" tabindex="-1"><a class="header-anchor" href="#root-preferences-xml" aria-hidden="true">#</a> root_preferences.xml</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PreferenceScreen</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>app</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res-auto<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PreferenceCategory</span> <span class="token attr-name"><span class="token namespace">app:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/messages_header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>EditTextPreference</span>
            <span class="token attr-name"><span class="token namespace">app:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>signature<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/signature_title<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>useSimpleSummaryProvider</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ListPreference</span>
            <span class="token attr-name"><span class="token namespace">app:</span>defaultValue</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>reply<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>entries</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@array/reply_entries<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>entryValues</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@array/reply_values<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>reply<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/reply_title<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>useSimpleSummaryProvider</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PreferenceCategory</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PreferenceCategory</span> <span class="token attr-name"><span class="token namespace">app:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/sync_header<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SwitchPreferenceCompat</span>
            <span class="token attr-name"><span class="token namespace">app:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sync<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/sync_title<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SwitchPreferenceCompat</span>
            <span class="token attr-name"><span class="token namespace">app:</span>dependency</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sync<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>attachment<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>summaryOff</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/attachment_summary_off<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>summaryOn</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/attachment_summary_on<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">app:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/attachment_title<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PreferenceCategory</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SwitchPreference</span>
        <span class="token attr-name"><span class="token namespace">app:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ethernet_turn_off<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">app:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ethernet_turn_off<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">app:</span>summary</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ethernet info<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>PreferenceScreen</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="build-gradle" tabindex="-1"><a class="header-anchor" href="#build-gradle" aria-hidden="true">#</a> build.gradle</h3><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>dependencies <span class="token punctuation">{</span>
    implementation &#39;androidx<span class="token punctuation">.</span>appcompat<span class="token operator">:</span>appcompat<span class="token operator">:</span><span class="token number">1.1</span><span class="token number">.0</span>&#39;
    implementation &#39;com<span class="token punctuation">.</span>google<span class="token punctuation">.</span>android<span class="token punctuation">.</span>material<span class="token operator">:</span>material<span class="token operator">:</span><span class="token number">1.1</span><span class="token number">.0</span>&#39;
    implementation &#39;androidx<span class="token punctuation">.</span>preference<span class="token operator">:</span>preference<span class="token operator">:</span><span class="token number">1.1</span><span class="token number">.1</span>&#39; <span class="token comment">//Preference的依赖包</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>关键就是要依赖preference的包。</p><h3 id="android-bp" tabindex="-1"><a class="header-anchor" href="#android-bp" aria-hidden="true">#</a> Android.bp</h3><p>Android 系统源码中Android.bp填入的包：</p><div class="language-makefile line-numbers-mode" data-ext="makefile"><pre class="language-makefile"><code><span class="token target symbol">    static_libs</span><span class="token punctuation">:</span> [
        <span class="token string">&quot;androidx-constraintlayout_constraintlayout&quot;</span>,
        <span class="token string">&quot;androidx.preference_preference&quot;</span>, //Preference的依赖包
        ...],
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="示例demo效果" tabindex="-1"><a class="header-anchor" href="#示例demo效果" aria-hidden="true">#</a> 示例demo效果：</h3><p><img src="https://raw.githubusercontent.com/shug666/image/main/imagesfb9b1cf0d16800866a9e4d58e6fc8f4f.gif" alt="在这里插入图片描述"></p><p>上面demo代码使用到的控件简单介绍：</p><ul><li><p>PreferenceScreen：xml布局界面的根属性</p></li><li><p>PreferenceCategory：类似layout里面的LinearLayout</p></li><li><p>EditTextPreference ：输入框组件，只在布局文件里面定义，点击条目就可以弹框输入内容，确认后显示在点击的条目上；</p></li><li><p>ListPreference：列表选择组件，只在布局文件里面定义，点击条目就可以弹框列表内容，确认后显示在点击的条目上；</p></li><li><p>SwitchPreference： 提供开关按钮功能的组件</p></li><li><p>SwitchPreferenceCompat： 提供开关按钮功能的组件，是后来随AndroidX Preference库引入的；</p></li><li><p>SwitchPreference和SwitchPreferenceCompat用法是完全一样的，最新的Preference库也是包含SwitchPreference的；</p></li><li><p>对于Android新版本比如Android13，SwitchPreferenceCompat兼容性会好一点。</p></li></ul><p>示例demo只是演示效果，很多其他相关的组件可以自己调试研究。</p><h2 id="preference小结" tabindex="-1"><a class="header-anchor" href="#preference小结" aria-hidden="true">#</a> Preference小结</h2><ul><li>Android的Preference是一组预设的UI组件，可以让开发者轻松地在应用程序中实现设置界面。</li><li>它包括各种类型的设置项，如开关、滑动条、单选按钮等。</li></ul><h3 id="主要的preference组件" tabindex="-1"><a class="header-anchor" href="#主要的preference组件" aria-hidden="true">#</a> 主要的Preference组件：</h3><div class="language-wiki line-numbers-mode" data-ext="wiki"><pre class="language-wiki"><code>(1) PreferenceScreen：根节点，代表一个偏好设置的屏幕。它是其他Preference组件的容器。
(2) EditTextPreference：允许用户输入文本值的偏好设置。
(3) CheckBoxPreference（在新版中被\`SwitchPreferenceCompat\`替代）：提供一个开关按钮供用户开启或关闭某个设置。
(4) SwitchPreferenceCompat：与CheckBoxPreference功能类似，提供一个滑动开关供用户切换设置。
(5) ListPreference：显示一个选择列表，用户可以从中选择一个选项作为设置。
(6) MultiSelectListPreference：允许用户从列表中选择多个选项。
(7) PreferenceCategory：用于将偏好设置分组的类别标题。
(8) PreferenceFragmentCompat：一个Fragment，用于在其内部显示一个偏好设置的屏幕。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="与android-preference相关的开发内容" tabindex="-1"><a class="header-anchor" href="#与android-preference相关的开发内容" aria-hidden="true">#</a> 与Android Preference相关的开发内容：</h3><div class="language-wiki line-numbers-mode" data-ext="wiki"><pre class="language-wiki"><code>1. 使用PreferenceFragment实现设置界面：
	PreferenceFragment是Android支持库中提供的一种用于实现设置界面的Fragment。
	通过继承PreferenceFragment类并重写onCreatePreferences方法，可以轻松地创建设置界面。

2. 使用PreferenceScreen配置设置项：
   PreferenceScreen是AndroidManifest.xml文件中的一个元素，用于配置应用程序的设置项。
   通过在PreferenceScreen元素中添加不同的元素，可以实现不同类型的设置项。

3. 使用SharedPreferences存储设置数据：
   SharedPreferences是Android中提供的一种轻量级的存储方式，用于存储应用程序的设置数据。
   通过调用PreferenceFragment类中的getSharedPreferences方法，
   可以获取到SharedPreferences对象，并通过编辑器进行数据的读写操作。

4. 使用Preference.OnPreferenceClickListener监听设置项点击事件：
	通过为设置项设置OnPreferenceClickListener监听器，可以在用户点击设置项时执行相应的操作。

5. 使用Preference.OnPreferenceChangeListener监听设置项变化事件：
	通过为设置项设置OnPreferenceChangeListener监听器，可以在用户修改设置项的值时执行相应的操作。
	
   总之，Android的Preference为开发者提供了一种方便快捷的方式来实现应用程序的设置界面，
   通过组合不同的元素和监听器，可以实现丰富的设置项功能。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="preference-标签属性及其含义" tabindex="-1"><a class="header-anchor" href="#preference-标签属性及其含义" aria-hidden="true">#</a> <code>Preference</code> 标签属性及其含义</h3><p>在Android开发中，<code>Preference</code> 是用于构建设置界面的一种简便方法。</p><p>它允许开发者以声明式的方式在XML文件中定义设置项，而不是手动创建UI。</p><p>每个 <code>Preference</code> 标签代表一个设置项，并且有多种属性来定义其行为和外观。</p><p>比如下面这个 PreferenceCategory 包含了很多标签属性：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PreferenceCategory</span>
        <span class="token attr-name"><span class="token namespace">android:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>multi_network_header<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@string/summary_placeholder<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@layout/preference_category_no_label<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">settings:</span>allowDividerBelow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>order</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>-40<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">settings:</span>controller</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.android.settings.network.MultiNetworkHeaderController<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>每个Preference 条目都有一些属性，那么这些属性的含义是什么呢？</p><p>以下是一些常见的 <code>Preference</code> 标签属性及其含义：</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>1. key: 这个属性定义了偏好设置的唯一标识符。通过这个键，你可以在代码中检索或更新偏好设置的值。
2. title: 设置项的标题，这是用户在设置界面看到的文本。
3. summary: 设置项的摘要或描述，显示在标题下方，用于提供更多关于设置项的信息。
4. defaultValue: 定义设置项的默认值。当应用第一次运行，且用户尚未更改过该设置时，将使用此默认值。
5. widgetLayout: 允许开发者为偏好设置项指定一个自定义的布局。
6. dependency: 这个属性使当前偏好设置依赖于另一个偏好设置的值。
例如，如果一个偏好设置项被禁用，直到另一个特定的偏好设置被激活/选中。
7. enabled: 控制偏好设置是否可用。默认为 true，即默认情况下是启用状态。
8. selectable: 控制偏好设置项是否可以被选中。默认为 true。
9. icon: 给设置项指定一个图标，以增加可识别性。
10. fragment: 指定当偏好设置被选中时，应该启动的Fragment的全名。这对于构建多层次的设置界面很有用。
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>上面只是一些主要标签属性，不同的组件还有不同的标签属性。</p><p>上面只是介绍了 Preference 的一些简单知识，入门是没有问题的；</p><p>但是狗歌开发的Settings会那么简单吗？</p><p>Preference相关组件除了Androidx的包定义那些类，</p><p>在Settings应用里面还用到了一些的SettingsLib包中自定义的Preference组件，如需要的请自行研究的。</p><h2 id="自定义preference" tabindex="-1"><a class="header-anchor" href="#自定义preference" aria-hidden="true">#</a> 自定义Preference</h2><h2 id="原机效果图" tabindex="-1"><a class="header-anchor" href="#原机效果图" aria-hidden="true">#</a> 原机效果图</h2><p><img src="https://raw.githubusercontent.com/shug666/image/main/images402aa900521069487a5efa8335303bca.png" alt=""></p><p>第一个Preference的UI布局：类似于设置模块中的RadioButtonPreference, 左边是一个标题，右侧是一个RadioButton</p><p>第二个Preference的UI布局：上面是一个导航样式图片，下面是一个文本演示，点击会跳转到另一个演示动画效果的界面</p><h2 id="ui布局代码" tabindex="-1"><a class="header-anchor" href="#ui布局代码" aria-hidden="true">#</a> UI布局代码</h2><h3 id="第一个preference布局" tabindex="-1"><a class="header-anchor" href="#第一个preference布局" aria-hidden="true">#</a> 第一个Preference布局</h3><p>第一个Preference的 layout 布局图, 里面的颜色，字体大小属性值都可以自己去适配</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- 1. layout布局文件： navigation_title_preference.xml --&gt;</span>
<span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RelativeLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>58dp<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@drawable/navigation_preference_bg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/navigation_type_title<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_alignParentLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginLeft</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_centerInParent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16sp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>textColor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#FF000000<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RadioButton</span>
        <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@android:id/checkbox<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_alignParentRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_marginRight</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30dp<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_centerInParent</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>focusable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>clickable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RelativeLayout</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 2.drawable navigation_preference_bg --&gt;</span>
<span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>selector</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name"><span class="token namespace">android:</span>state_pressed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span>      <span class="token attr-name"><span class="token namespace">android:</span>drawable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@drawable/navi_pressed_false<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>item</span> <span class="token attr-name"><span class="token namespace">android:</span>state_pressed</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>  
<span class="token attr-name"><span class="token namespace">android:</span>drawable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@drawable/navi_pressed_true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>selector</span><span class="token punctuation">&gt;</span></span>


<span class="token comment">&lt;!-- 3. drawable  navi_pressed_false --&gt;</span>
<span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>shape</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>shape</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rectangle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>solid</span> <span class="token attr-name"><span class="token namespace">android:</span>color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@color/search_bar_background<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>corners</span> <span class="token attr-name"><span class="token namespace">android:</span>radius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>9dp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>shape</span><span class="token punctuation">&gt;</span></span>


<span class="token comment">&lt;!-- 4. drawable  navi_pressed_true --&gt;</span>
<span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>shape</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>shape</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>rectangle<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>solid</span> <span class="token attr-name"><span class="token namespace">android:</span>color</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#1a000000<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>corners</span> <span class="token attr-name"><span class="token namespace">android:</span>radius</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>9dp<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>shape</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="第二个preference布局" tabindex="-1"><a class="header-anchor" href="#第二个preference布局" aria-hidden="true">#</a> 第二个Preference布局</h3><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- layout 布局文件：navigation_preference.xml --&gt;</span>
<span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RelativeLayout</span> <span class="token attr-name"><span class="token namespace">xmlns:</span>android</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://schemas.android.com/apk/res/android<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>155dp<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@drawable/navigation_preference_bg<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RelativeLayout</span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>match_parent<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap_content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ImageView</span>
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/navigation_type_icon<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_marginTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>26dp<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>240dp<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>70dp<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_centerHorizontal</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TextView</span>
            <span class="token attr-name"><span class="token namespace">android:</span>id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@+id/demonstration_effect<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>90dp<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>34dp<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_below</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@id/navigation_type_icon<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_marginTop</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16dp<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_marginBottom</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>9dp<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>background</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@drawable/navigation_preference_bg<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>gravity</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>center<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>layout_centerHorizontal</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>textColor</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>#268AFF<span class="token punctuation">&quot;</span></span>
            <span class="token attr-name"><span class="token namespace">android:</span>textSize</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>16sp<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RelativeLayout</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RelativeLayout</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="自定义属性" tabindex="-1"><a class="header-anchor" href="#自定义属性" aria-hidden="true">#</a> 自定义属性</h3><p>两个Preference需要用到的属性：自定义标题，自定义图片，自定义文本的属性，需要前期声明， 这样子可以在xml文件直接配置 preference:navigationTitle    preference:naviDrawable  preference:naviDetail 的值。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- 第一个Preference的title属性 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>declare-styleable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>NavigationTitlePreference<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>navigationTitle<span class="token punctuation">&quot;</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>string<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>declare-styleable</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 第二个Preference的图片和文本的属性 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>declare-styleable</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>NavigationPreference<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>naviDrawable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>reference<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>attr</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>naviDetail<span class="token punctuation">&quot;</span></span> <span class="token attr-name">format</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>string<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>declare-styleable</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="自定义preference-代码" tabindex="-1"><a class="header-anchor" href="#自定义preference-代码" aria-hidden="true">#</a> 自定义Preference 代码</h2><h3 id="第一个preference" tabindex="-1"><a class="header-anchor" href="#第一个preference" aria-hidden="true">#</a> 第一个Preference</h3><p>第一个Preference类似于源生的RadioButtonPreference控件，只是布局不一样，通过继承相同的父类CheckBoxPreference，可以实现自定义的Preference，代码如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NavigationTitlePreference</span> <span class="token keyword">extends</span> <span class="token class-name">CheckBoxPreference</span> <span class="token punctuation">{</span>

    <span class="token comment">//Preference的点击事件自定义接口</span>
    <span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OnClickListener</span> <span class="token punctuation">{</span>
        <span class="token keyword">void</span> <span class="token function">onNaviPrefernceClicked</span><span class="token punctuation">(</span><span class="token class-name">NavigationTitlePreference</span> emiter<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">OnClickListener</span> mNaviTitleOnClickListener<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setNaviTitleOnClickListener</span><span class="token punctuation">(</span><span class="token class-name">OnClickListener</span> onClickListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        mNaviTitleOnClickListener <span class="token operator">=</span> onClickListener<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">TextView</span> mTextView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mNavigationTitle<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">NavigationTitlePreference</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">AttributeSet</span> attrs<span class="token punctuation">,</span> <span class="token keyword">int</span> defStyle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> attrs<span class="token punctuation">,</span> defStyle<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">TypedArray</span> attributes <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">obtainStyledAttributes</span><span class="token punctuation">(</span>attrs<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>NavigationTitlePreference<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// if these are already set that means they were set dynamically and don&#39;t need</span>
        <span class="token comment">// to be loaded from xml</span>
        mNavigationTitle <span class="token operator">=</span> <span class="token punctuation">(</span>mNavigationTitle <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span>
                attributes<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>NavigationTitlePreference_navigationTitle<span class="token punctuation">)</span> <span class="token operator">:</span> mNavigationTitle<span class="token punctuation">;</span>
        <span class="token function">setLayoutResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>navigation_title_preference<span class="token punctuation">)</span><span class="token punctuation">;</span>
        attributes<span class="token punctuation">.</span><span class="token function">recycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">NavigationTitlePreference</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">AttributeSet</span> attrs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> attrs<span class="token punctuation">,</span> <span class="token class-name">TypedArrayUtils</span><span class="token punctuation">.</span><span class="token function">getAttr</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span>
                <span class="token class-name"><span class="token namespace">androidx<span class="token punctuation">.</span>preference<span class="token punctuation">.</span></span>R</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>preferenceStyle<span class="token punctuation">,</span>
                <span class="token class-name"><span class="token namespace">android<span class="token punctuation">.</span></span>R</span><span class="token punctuation">.</span>attr<span class="token punctuation">.</span>preferenceStyle<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">NavigationTitlePreference</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span><span class="token class-name">PreferenceViewHolder</span> view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onBindViewHolder</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTextView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span>view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>navigation_type_title<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTextView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mNavigationTitle<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">!=</span> mNaviTitleOnClickListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            mNaviTitleOnClickListener<span class="token punctuation">.</span><span class="token function">onNaviPrefernceClicked</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码解读" tabindex="-1"><a class="header-anchor" href="#代码解读" aria-hidden="true">#</a> 代码解读</h3><p>1. 自定义类是继承于CheckBoxPreference，它里面已经对按钮（比如 RadioButton,  SwitchButton）已经做了事件处理，我们只需要设置按钮的id为：<code>android:id=&quot;@android:id/checkbox&quot;</code> 即可, 父类代码如下：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// CheckBoxPreference.java </span>
<span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onBindView</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onBindView</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">View</span> checkboxView <span class="token operator">=</span> view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>internal<span class="token punctuation">.</span></span>R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>checkbox<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>checkboxView <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> checkboxView <span class="token keyword">instanceof</span> <span class="token class-name">Checkable</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Checkable</span><span class="token punctuation">)</span> checkboxView<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setChecked</span><span class="token punctuation">(</span>mChecked<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.  Preference的点击事件自定义接口</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OnClickListener</span> <span class="token punctuation">{</span>  
	<span class="token keyword">void</span> <span class="token function">onNaviPrefernceClicked</span><span class="token punctuation">(</span><span class="token class-name">NavigationTitlePreference</span> emiter<span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="第二个preference" tabindex="-1"><a class="header-anchor" href="#第二个preference" aria-hidden="true">#</a> 第二个Preference</h3><p>继承Preference, 组成元素为 一张图片和一个文本，点击文本会跳转到相应的动画演示界面， 不需要图片点击事件， 不需要整个Preference的点击事件</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NavigationPreference</span> <span class="token keyword">extends</span> <span class="token class-name">Preference</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">TextView</span> mTextView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">ImageView</span> mImageView<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> mNavigationDrawable<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mNavigationDetail<span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token class-name">NavigationPreference</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">AttributeSet</span> attrs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">init</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> attrs<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">NavigationPreference</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">init</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Context</span> context<span class="token punctuation">,</span> <span class="token class-name">AttributeSet</span> attrs<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">TypedArray</span> attributes <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">obtainStyledAttributes</span><span class="token punctuation">(</span>attrs<span class="token punctuation">,</span> <span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>NavigationPreference<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// if these are already set that means they were set dynamically and don&#39;t need</span>
        <span class="token comment">// to be loaded from xml</span>
        mNavigationDrawable <span class="token operator">=</span> <span class="token punctuation">(</span>mNavigationDrawable <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span>
                attributes<span class="token punctuation">.</span><span class="token function">getResourceId</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>NavigationPreference_naviDrawable<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">:</span> mNavigationDrawable<span class="token punctuation">;</span>

        mNavigationDetail <span class="token operator">=</span> <span class="token punctuation">(</span>mNavigationDetail <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">?</span>
                attributes<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>styleable<span class="token punctuation">.</span>NavigationPreference_naviDetail<span class="token punctuation">)</span> <span class="token operator">:</span> mNavigationDetail<span class="token punctuation">;</span>

        <span class="token function">setLayoutResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>navigation_preference<span class="token punctuation">)</span><span class="token punctuation">;</span>

        attributes<span class="token punctuation">.</span><span class="token function">recycle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span><span class="token class-name">PreferenceViewHolder</span> view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onBindViewHolder</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTextView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">TextView</span><span class="token punctuation">)</span>view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>demonstration_effect<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTextView<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span>mNavigationDetail<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mTextView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">View<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token annotation punctuation">@Override</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    context<span class="token punctuation">.</span><span class="token function">startActivity</span><span class="token punctuation">(</span><span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mImageView <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">ImageView</span><span class="token punctuation">)</span>view<span class="token punctuation">.</span><span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>navigation_type_icon<span class="token punctuation">)</span><span class="token punctuation">;</span>
        mImageView<span class="token punctuation">.</span><span class="token function">setImageResource</span><span class="token punctuation">(</span>mNavigationDrawable<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//点击整个Preference时，无响应事件的关键代码</span>
        view<span class="token punctuation">.</span>itemView<span class="token punctuation">.</span><span class="token function">setClickable</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="代码解读-1" tabindex="-1"><a class="header-anchor" href="#代码解读-1" aria-hidden="true">#</a> 代码解读</h3><p>1.  点击整个自定义Preference时设置为不可点击<code>view.itemView.setClickable(false);</code>无响应事件的关键代码，原理如下：</p><p>在 super.onBindViewHolder(view)中</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onBindViewHolder</span><span class="token punctuation">(</span><span class="token class-name">PreferenceViewHolder</span> holder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">View</span> itemView <span class="token operator">=</span> holder<span class="token punctuation">.</span>itemView<span class="token punctuation">;</span>
        <span class="token class-name">Integer</span> summaryTextColor <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        
        <span class="token comment">//设置 itemView 的点击事件</span>
        itemView<span class="token punctuation">.</span><span class="token function">setOnClickListener</span><span class="token punctuation">(</span>mClickListener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>当点击后，会执行父类Preference.java 中的 performClick方法时，直接return了。</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code> <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">performClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">performClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

 <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">performClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//当设置不可点击，或者不可选择的时候，就直接return了。        </span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">isSelectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>mOnClickListener <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> mOnClickListener<span class="token punctuation">.</span><span class="token function">onPreferenceClick</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">PreferenceManager</span> preferenceManager <span class="token operator">=</span> <span class="token function">getPreferenceManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>preferenceManager <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">PreferenceManager<span class="token punctuation">.</span>OnPreferenceTreeClickListener</span> listener <span class="token operator">=</span> preferenceManager
                    <span class="token punctuation">.</span><span class="token function">getOnPreferenceTreeClickListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>listener <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> listener<span class="token punctuation">.</span><span class="token function">onPreferenceTreeClick</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>mIntent <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            context<span class="token punctuation">.</span><span class="token function">startActivity</span><span class="token punctuation">(</span>mIntent<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2.  点击文本的响应代码：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>  
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onClick</span><span class="token punctuation">(</span><span class="token class-name">View</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>  
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>  
        <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
        context<span class="token punctuation">.</span><span class="token function">startActivity</span><span class="token punctuation">(</span><span class="token function">getIntent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里的intent是通过 xml文件配置的intent参数，从而跳转到目标界面, 如下：</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Preference</span>
        <span class="token attr-name"><span class="token namespace">android:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xxxx<span class="token punctuation">&quot;</span></span>
        <span class="token attr-name"><span class="token namespace">android:</span>title</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>xxxxx<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        // 举个例子 通过配置intent参数，跳转到指定的界面
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>intent</span> <span class="token attr-name"><span class="token namespace">android:</span>action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>android.credentials.INSTALL_AS_USER<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name"><span class="token namespace">android:</span>targetPackage</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.android.certinstaller<span class="token punctuation">&quot;</span></span>
                <span class="token attr-name"><span class="token namespace">android:</span>targetClass</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>com.android.certinstaller.CertInstallerMain<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
               <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>extra</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>install_as_uid<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">android:</span>value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1010<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>intent</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Preference</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="设置界面代码" tabindex="-1"><a class="header-anchor" href="#设置界面代码" aria-hidden="true">#</a> 设置界面代码</h2><p>自定义的Preference代码完成后，接下来就开始写界面加载的xml文件了</p><p>布局文件：navigation_type_settings.xml</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">&quot;1.0&quot;</span> encoding<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span><span class="token operator">?</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token class-name">PreferenceScreen</span> xmlns<span class="token operator">:</span>android<span class="token operator">=</span><span class="token string">&quot;http://schemas.android.com/apk/res/android&quot;</span>
    xmlns<span class="token operator">:</span>preference<span class="token operator">=</span><span class="token string">&quot;http://schemas.android.com/apk/res-auto&quot;</span>
    android<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;gesture_system_navigation_type&quot;</span>
    android<span class="token operator">:</span>title<span class="token operator">=</span><span class="token string">&quot;@string/system_navigation_title&quot;</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>gestures<span class="token punctuation">.</span></span>NavigationTitlePreference</span>
        android<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;gesture_navi&quot;</span>
        <span class="token comment">//自定义的title</span>
        preference<span class="token operator">:</span>navigationTitle<span class="token operator">=</span><span class="token string">&quot;@string/system_gesture_navigation_title&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>gestures<span class="token punctuation">.</span></span>NavigationPreference</span>
        android<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;gesture_navi_drawable&quot;</span>
       <span class="token comment">//自定义的图片</span>
        preference<span class="token operator">:</span>naviDrawable<span class="token operator">=</span><span class="token string">&quot;@drawable/ic_gesture_navigation&quot;</span>
       <span class="token comment">//自定义文本</span>
        preference<span class="token operator">:</span>naviDetail<span class="token operator">=</span><span class="token string">&quot;@string/demonstration_effect&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>intent
            android<span class="token operator">:</span>action<span class="token operator">=</span><span class="token string">&quot;android.intent.action.MAIN&quot;</span>
            android<span class="token operator">:</span>targetPackage<span class="token operator">=</span><span class="token string">&quot;com.android.settings&quot;</span>
            android<span class="token operator">:</span>targetClass<span class="token operator">=</span><span class="token string">&quot;com.android.settings.Settings$GestureNaviSettingsActivity&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>gestures<span class="token punctuation">.</span></span>NavigationPreference</span><span class="token operator">&gt;</span>


    <span class="token operator">&lt;</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>gestures<span class="token punctuation">.</span></span>NavigationTitlePreference</span>
        android<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;virtual_navi&quot;</span>
        preference<span class="token operator">:</span>navigationTitle<span class="token operator">=</span><span class="token string">&quot;@string/system_virtual_navigation_title&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>gestures<span class="token punctuation">.</span></span>NavigationPreference</span>
        android<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;virtual_navi_drawable&quot;</span>
        preference<span class="token operator">:</span>naviDrawable<span class="token operator">=</span><span class="token string">&quot;@drawable/ic_virtual_navigation&quot;</span>
        preference<span class="token operator">:</span>naviDetail<span class="token operator">=</span><span class="token string">&quot;@string/demonstration_effect&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>intent
            android<span class="token operator">:</span>action<span class="token operator">=</span><span class="token string">&quot;android.intent.action.MAIN&quot;</span>
            android<span class="token operator">:</span>targetPackage<span class="token operator">=</span><span class="token string">&quot;com.android.settings&quot;</span>
            android<span class="token operator">:</span>targetClass<span class="token operator">=</span><span class="token string">&quot;com.android.settings.Settings$VirtualNaviSettingsActivity&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>android<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>gestures<span class="token punctuation">.</span></span>NavigationPreference</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span><span class="token class-name">PreferenceScreen</span><span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>界面加载菜单代码：</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NavigationTypeSettings</span> <span class="token keyword">extends</span> <span class="token class-name">SettingsPreferenceFragment</span> <span class="token keyword">implements</span>
        <span class="token class-name">NavigationTitlePreference<span class="token punctuation">.</span>OnClickListener</span><span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">KEY_GESTURE</span> <span class="token operator">=</span> <span class="token string">&quot;gesture_navi&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">KEY_VIRTUAL</span> <span class="token operator">=</span> <span class="token string">&quot;virtual_navi&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">NavigationTitlePreference</span> mGestureNaviPref<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">NavigationTitlePreference</span> mVirtualNaviPref<span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> icicle<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>icicle<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//加载界面</span>
        <span class="token function">addPreferencesFromResource</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>xml<span class="token punctuation">.</span>navigation_type_settings<span class="token punctuation">)</span><span class="token punctuation">;</span>

     
        <span class="token class-name">PreferenceScreen</span> root <span class="token operator">=</span> <span class="token function">getPreferenceScreen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mGestureNaviPref <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NavigationTitlePreference</span><span class="token punctuation">)</span>root<span class="token punctuation">.</span><span class="token function">findPreference</span><span class="token punctuation">(</span><span class="token constant">KEY_GESTURE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVirtualNaviPref <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">NavigationTitlePreference</span><span class="token punctuation">)</span>root<span class="token punctuation">.</span><span class="token function">findPreference</span><span class="token punctuation">(</span><span class="token constant">KEY_VIRTUAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//自定义Preference的监听事件</span>
        mGestureNaviPref<span class="token punctuation">.</span><span class="token function">setNaviTitleOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mVirtualNaviPref<span class="token punctuation">.</span><span class="token function">setNaviTitleOnClickListener</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

   
   <span class="token comment">//点击Preference的回调方法处理</span>
   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onNaviPrefernceClicked</span><span class="token punctuation">(</span><span class="token class-name">NavigationTitlePreference</span> emiter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
   <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="自定义preference总结" tabindex="-1"><a class="header-anchor" href="#自定义preference总结" aria-hidden="true">#</a> 自定义Preference总结</h2><p>本篇文章是对自定义Preference的一个小结，只写了UI界面和点击响应事件，具体的逻辑看项目需求，只是一个抛砖引玉的Demo，设置模块已经有比较成熟的Preference控件，当有自定义的Preference的需求，根据情况继承类似的Preference去造轮子。对于UI事件的处理，本文中有响应整个Preference的事件处理，也有只需要响应其中一个子控件的事件处理，关键还是要多看和理解源码，面向对象编程继承和多态的灵活应用， 后续在工作项目中再多多总结吧。</p><p>本文转自 https://blog.csdn.net/u012514113/article/details/125233201，如有侵权，请联系删除。</p>`,104),r={href:"https://blog.csdn.net/wenzhi20102321/article/details/136902514",target:"_blank",rel:"noopener noreferrer"};function k(d,v){const s=e("ExternalLinkIcon");return p(),c("div",null,[u,a("p",null,[n("本文转自 "),a("a",r,[n("https://blog.csdn.net/wenzhi20102321/article/details/136902514"),o(s)]),n("，如有侵权，请联系删除。")])])}const b=t(i,[["render",k],["__file","zidingyiPreferencejiangjie.html.vue"]]);export{b as default};
